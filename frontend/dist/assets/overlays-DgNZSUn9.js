function v(n){document.querySelectorAll(`.${n}`).forEach(e=>e.remove())}function C(n,e,h,g,m){const{data:{dom:{classes:p}},services:{stateManager:S}}=g,x=p.textEditOverlay;v(x);const i=n.getBoundingClientRect(),E=n.getContext("2d");E.font=`${e.fontWeight??"bold"} ${e.fontSize??32}px ${e.fontFamily??"sans-serif"}`;const w=E.measureText(e.text).width+16,b=(e.fontSize??32)+8,T=i.left+e.x*(i.width/n.width)-w/2,z=i.top+e.y*(i.height/n.height)-b/2,t=document.createElement("div");t.className=x,Object.assign(t.style,{position:"absolute",left:`${T}px`,top:`${z+b+10}px`,zIndex:"10000",padding:"12px",background:"rgba(255,255,255,0.97)",border:"1.5px solid #b4b4b4",borderRadius:"8px",boxShadow:"0 2px 14px #0003",minWidth:"220px"});const o=document.createElement("input");o.type="text",o.value=e.text,o.style.width="100%";const l=document.createElement("select");l.className=p.fontSelector,["Arial","Impact","Comic Sans MS","Times New Roman"].forEach(a=>{const u=document.createElement("option");u.value=a,u.text=a,e.fontFamily===a&&(u.selected=!0),l.appendChild(u)});const c=document.createElement("input");c.type="number",c.min="8",c.max="200",c.value=String(e.fontSize);const d=document.createElement("input");d.type="color",d.value=e.color;const s=document.createElement("button");s.innerText="Done",s.type="button";const r=document.createElement("button");r.innerText="Cancel",r.type="button",r.style.marginLeft="8px",t.append("Text:",document.createElement("br"),o,document.createElement("br"),"Font:",document.createElement("br"),l,document.createElement("br"),"Size:",document.createElement("br"),c,document.createElement("br"),"Color:",document.createElement("br"),d,document.createElement("br"),s,r);function y(){S.updateTextElement(h,{...e,text:o.value,fontFamily:l.value,fontSize:parseInt(c.value,10),color:d.value}),t.remove(),m()}function f(){t.remove(),m()}s.addEventListener("click",y),r.addEventListener("click",f),t.addEventListener("keydown",a=>{a.key==="Escape"&&f(),a.key==="Enter"&&y()}),setTimeout(()=>o.focus(),20),document.body.appendChild(t)}const k={removeExistingOverlay:v,showTxtElemOverlay:C};export{k as overlayFns};
